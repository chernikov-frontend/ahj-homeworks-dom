(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function n(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var i=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.goblinElement=document.createElement("div"),this.goblinElement.classList.add("goblin"),this.isVisible=!1},(n=[{key:"show",value:function(t){this.isVisible&&this.hide(),t.appendChild(this.goblinElement),this.isVisible=!0}},{key:"hide",value:function(){this.goblinElement.parentElement&&this.goblinElement.parentElement.replaceChildren(),this.isVisible=!1}},{key:"getElement",value:function(){return this.goblinElement}}])&&e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}();function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,l(i.key),i)}}function l(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}var s=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.score=0,this.scoreElement=document.getElementById("score")},(e=[{key:"increment",value:function(){this.score++,this.updateScore()}},{key:"getScore",value:function(){return this.score}},{key:"updateScore",value:function(){this.scoreElement.textContent="Счет: ".concat(this.score)}}])&&r(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,u(i.key),i)}}function u(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}var m=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.boardSize=e,this.board=document.getElementById("game-board"),this.goblin=new i,this.score=new s,this.missedClicks=0,this.maxMissed=5,this.interval=null,this.timeout=null},(e=[{key:"init",value:function(){this.createBoard(),this.startGame()}},{key:"createBoard",value:function(){var t=this;this.board.innerHTML="";for(var e=0;e<this.boardSize*this.boardSize;e++){var n=document.createElement("div");n.classList.add("cell"),this.board.appendChild(n)}this.board.addEventListener("click",(function(e){var n=e.target;n.classList.contains("cell")&&!n.contains(t.goblin.getElement())&&(t.missedClicks++,console.log("Промах номер: ".concat(t.missedClicks," (клик по клетке)")),t.missedClicks>=t.maxMissed&&t.endGame())}))}},{key:"startGame",value:function(){var t=this;this.interval=setInterval((function(){t.moveGoblin()}),1e3)}},{key:"moveGoblin",value:function(){var t=this,e=document.querySelectorAll(".cell"),n=Math.floor(Math.random()*e.length);this.goblin.show(e[n]),this.timeout&&clearTimeout(this.timeout),this.goblin.getElement().onclick=function(e){e.stopPropagation(),t.score.increment(),t.goblin.hide(),console.log("Гоблин пойман и скрыт."),t.missedClicks=0,t.timeout&&clearTimeout(t.timeout)},this.timeout=setTimeout((function(){t.goblin.isVisible&&(t.missedClicks++,console.log("Промах номер: ".concat(t.missedClicks," (гоблин не пойман)")),t.goblin.hide()),t.missedClicks>=t.maxMissed&&t.endGame()}),1e3)}},{key:"endGame",value:function(){clearInterval(this.interval),this.timeout&&clearTimeout(this.timeout),alert("Игра окончена! Ваш счет: ".concat(this.score.getScore()))}}])&&c(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();document.addEventListener("DOMContentLoaded",(function(){(new m).init()}))})();